

\cleardoublepage

\chapter{Introduction}

\section{Background}
Skin cancer is considered amongst the most severe public health concerns, with mortality rates of 2,353 per 100,000 within the United Kingdom (UK) in 2018\cite{UK2019}. Skin cancers can be categorised between melanoma and non-melanoma, whereas melanoma is the most dangerous because it is unpredictable. When left untreated and after growing sufficiently, it can spread to other regions of the body (known as metastatic melanoma), which once progressed is challenging to treat effectively with a 10\% survival over ten years in the US\cite{bhatia2009}. Furthermore, it is beneficial to catch melanoma early because it is the most easily treatable form of cancer, with 86\% of cases being preventable\cite{UK2019}. However, melanoma can remain dormant from anywhere between 6 months to 10 years before maturing and becoming a danger to the patient\cite{UK2019}. Another danger of melanoma is its similarity to non-melanoma skin cancers, such as a mimic called seborrhoeic keratosis (SK), which frequently leads to misdiagnoses\cite{Izikson2002}. There are features unique to SK called fissures, ridges, and hairpin vessels\cite{Minagawa2017}. Problematically these features require trained specialists to recognise them needing more than ten years of experience to have an accuracy of 86\% compared to 62\% or 56\% (3 to 5 years of experience)\cite{Morton1998}. However, because of the cost of training new doctors, there are limited available. Dermatologists primarily treat skin conditions (biopsies) and confirm diagnoses submitted by GP. General practitioners (GP) are the first to diagnose skin conditions and sometimes have limited experience diagnosing them (especially dermatological features). This project aims to improve the accuracy of GP observations by providing tools for the automatic classification of skin lesions. For the previously mentioned reasons, an automatic system should be cost-effective and advantageous to doctors.

\subsection{Diagnostic Procedures (ABCD Rules, CASH, 7-Point Checklist, Texture)}
%Diagnostic procedures
Diagnostic procedures are instructions developed by doctors to simplify diagnosing conditions. Various methods have been developed to diagnose skin lesions and have greatly improved GP accuracy within clinical environments\cite{Nachbar1994, unlu2014}. Considering melanoma is the most dangerous skin condition, most procedures were developed specifically for early detection. Some include ABCD rules, 2-point checklist, 7-point checklist, and CASH. The most preferred of these techniques are ABCD rules and CASH because they have a higher sensitivity\cite{unlu2014} and ABCD rules are generally the most preferred because it is easy to learn and is rapidly calculated\cite{Nachbar1994}. There are several variations of ABCD rules, but, is originally measured using asymmetry, border, colour, and diameter. Diameter is sometimes replaced with dermatological structures because many features (i.e. blue-black signs, pigment networks, pseudopods, streaks, or milia-like cysts\cite{Stricklin2011}) improve the classification accuracy between melanoma and the mimic seborrheic keratosis\cite{Cognetta1994}. Furthermore, automatically measuring diameter is often difficult because it is dependent on the photo apparatus and the distance from the skin lesion, which is rarely consistent in research. Table \ref{TDS} describes each rule in more detail, including a scoring system called total dermoscopy score (TDS), where each rule is assigned a score and combined to reach a result of either malignant, suspicious or benign. The criteria is: [(Asymmetry $\times$ 1.3) + (Border $\times$ 0.1) + (Colour $\times$ 0.5) + (Dermoscopic structure $\times$ 0.5)]. Each rule is calculated using the following descriptions in Table \ref{TDS} and multiplied by their weight and then added together to reach a final score where [$<$ 4.76 = benign, $>$ 4.76 or $<$ 5.45 = suspicious, $>$ 5.45 = melanoma]. The disadvantage is the subjectivity of GP observations relating to their experience. So, it would be beneficial to automate the techniques using algorithms to standardise results and improve GP accuracy.

\begin{table}
\small
\begin{tabular}{|p{2.5cm}|p{10cm}|c|c|}
	\hline
	Criteria & Methodology & Score & Weight \\
	\hline
	Asymmetry & Measuring asymmetry involves first finding the centroid and splitting it twice with a 90-degree axis. Each side is subtracted with its opposite half to measure the asymmetry of shape, colour, and dermoscopic structures. If both sides are asymmetrical then the score is 2, one side asymmetrical is a score of 1, and otherwise, the score is 0. & 0 - 2 & $\times$ 1.3 
	\\
	\hline
	Border & border is found by finding the centroid and drawing lines through it with a 45-degree angle, splitting the skin lesion into eight segments. Border segments might be irregular with convexity, sharp corners, or edges. Irregular segments are incremented by 1, reaching 8 for each segment.  & 0 - 8 & $\times$ 1.3 
	\\
	\hline
	Colour & The area of the skin lesion is up to 6 colours (white, red, light brown, dark brown, blue-grey, black). The score is increased by 1 for each visible colour, reaching a total of 6. & 1 - 6 & $\times$ 0.5 
	\\
	\hline
	Dermoscopic Structures & Dermoscopic structures are measured by finding structureless areas, pigment networks, atypical networks, dots, and globules. Each visible structure adds a score of 1, reaching a total of 5. & 1 - 5 & $\times$ 0.5 
	\\
	\hline	
\end{tabular}

\caption{Total dermoscopy score (TDS) is a scoring system used with ABCD rules to support clinicians when diagnosing melanoma\cite{Cognetta1994}. Each rule is multiplied by weights and the sum of the combined values is the final score, all together: [(Asymmetry $\times$ 1.3) $+$ (Border $\times$ 0.1) $+$ (Colour $\times$ 0.5) $+$ (Dermoscopic structure $\times$ 0.5)].}
\end{table} \label{TDS}

\subsection{UI Development and visualisation}
The user interface (UI) being the method in which algorithms are visualised is arguably the most import section of this project because without the means of presenting algorithms in an explainable way they are of little to no use to healthcare professionals. Providing explanations will improve trust from doctors and patients to these algorithms\cite{BarredoArrieta2020}. This is also crucial for the successful implementation of AI technologies within healthcare settings\cite{skar2017}.

%What type of CAD framework
Computer-aided diagnostic (CAD) frameworks are a collection of algorithms designed to guide decision-making processes within clinical environments\cite{Dick2019}. A paper written by Andre Estava demonstrates a deep convolutional neural network (DCNN) that has comparable accuracy to that of dermatologists, trained using 129,450 clinical images consisting of 2,032 different diseases\cite{Andre2017}. DCNN generates a collection of artificial neurons organised into layers, where each neuron receives input from a previous layer to perform a computation. The collection of layers is a network, which (once trained) ultimately measures the relationship between input parameters based on provided data. It is important to note that the accuracy is proportionate to the number of images and data quality for training that network. Unfortunately, these image samples are frequently private and unavailable to many institutions. Without adequate image data to test the capabilities of machine learning models, there is no method for measuring these biases and is therefore unsafe to use within clinical environments. Secondly, these approaches will often produce a parallel diagnosis, meaning that results are not always explainable\cite{Lipton2018}. There are many valuable techniques, but even the best techniques are inadequate for doctors without catering to interpretability. Other techniques are interpretable by considering diagnostic procedures, such as ABCD rules, many of which are described by Ali\cite{Ali2020}. Techniques based on diagnostic procedures can be more easily tested for biases and provide further insight to GPs with the means to learn from and understand results. Techniques include support vector machine (SVM), a supervised machine learning that uses regression analysis to categorise labelled data into two or more groups. The advantage means less data for training is required, and the model is interpretable.

% Visualisation
Doctors will often only have access to a patient for a short time before moving to another. CAD frameworks are beneficial because they speed up the process, can improve accuracy\cite{Dick2019}, and ensure the gathering of relevant data (ABCD rules). Furthermore, it could take days for a second opinion from another doctor, where an automatic system immediately provides it. Automated systems should also provide adequate explanations that can be understood quickly and easily by doctors\cite{Lipton2018}. One method is to provide visual explanations. Many authors\cite{Zaqout2016, Kasmi2016, Ali2020a} describe different ways to measure ABCD rules, including the asymmetry of skin lesions using bi-fold. Automated versions of the procedure use the centroid and moments of inertia to fold the skin lesion horizontally and vertically along the centroid. The overhung area on both axes is subtracted from the final score to measure asymmetrical or symmetrical. This technique produces an adequate visualisation that can provide GPs with an interpretable result. There is a range of other examples for ABCD rules, including border\cite{Kasmi2016, Zaqout2016, Ali2020b}, colour\cite{She2007, Tenenhaus2010, Kasmi2016}, and dermoscopic structures\cite{Lopez-Labraca2018} that use a range of interpretable algorithms that produce interpretable results.

%Discuss the difficulty of diagnosing showing NHS data relating to ABCD rules, size, etc


%Poster for a conference


%Mention 2 conferences
%Mention getting IRAS approval because this is an achievement of sorts

\subsection{Conclusion}
Overall, many advanced machine learning techniques using neural networks lack the interpretability required within clinical environments. Furthermore, public datasets lack rarer skin conditions, making finding biases challenging. Automating the ABCD rules can solve this by using a technique that GPs are familiar with, and by using statistical models to extract relevant features (relating to the ABCD rules). This is followed by summarising rules using Bayesian fusion and calculating the significance of individual features.

\section{Purpose and Research Questions}
In this thesis machine learning algorithms were developed for the automatic classification of skin lesions with consideration for its use within clinical environments. Furthermore, the technqiues need to produce an explainable and meaningful response that can support doctors (dermotologists and general practioners) by providing insights and details that might have been missed. Concerning this, two main research questions:

\begin{itemize}
	\item Are the produced algorithms accurate enough to be properly utilised in a clincal environment?
	\item Does the developed technique provide meaningful responses that can be properly utilised within a clinical environemnt?
\end{itemize}

\section{Scope and Limitations (Use-Case)}
Some limitations were set by the company partner based on where they plan to utilise the developed algorithms. In this case the technique is primarly going to be utilised by GP (general practitioners) that are unlikely to have the specific training and equipment for diagnosing skin lesions.

\begin{itemize}
	\item The algorithms are developed for the detection of Benign Naevi (BN), Melanoma (MM), Seborrhoeic keratosis (SK), Atypical Naevi (AN), Typical Naevi (TN), Squamous Cell Carcinoma (SCC), Basal Cell Carcinoma (BCC). With a primary focus on SK consdering its difficulty to diagnose.
	\item Macroscopic images will be analysed instead of dermoscopes. This essentially means a standard camera will be used, which includes variations in lighting which might obscure features in skin lesions.
	\item Meta-data includes area on body, gender, Date of Birth (DOB), department, Diagnosis. The goal is to utilise this data for automatic detection.
	\item Techniques must be explainable, so that doctors can recognise incorrect responses.
\end{itemize}

\section{Target Group}
The work is primarly for general practioners (GPs) because it is usually the source of misdiagnosed skin lesions due to the lack of specific training compared to dermatologists. The goal is to improve the accruacy of techniques using a cheap device for capturing data, furthermore automatic classification should provide a more adequate means for dermotologists to search for cases.

\section{Aim}
\begin{itemize}
	\item Develop an interpretable CAD framework based on the ABCD rules to diagnose skin lesions automatically. The goal is to utilise statistical models to extract each ABCD rule (asymmetry, border, colour, and Dermoscopic structure). Each rule will be trained using individual SVM models and are combined using Bayesian Fusion.
\end{itemize}

\section{Objectives}
\begin{itemize}

	\item Develop and validate skin lesion segmentation and border cut-off approach for improved irregularity detection of ABCD rules using SegNet and LBPC.
	\item Develop and validate melanoma classification based on the diagnostic procedure ABCD rules (asymmetry, border, colour, and dermoscopic structures) for improved interpretability to doctors using various statistical techniques and SVM models.
	\item Develop and validate combining ABCD rules for the probabilistic analysis of the most dependent features using Bayesian fusion. This could include meta-data for gender, age, touch, feeling, and location on the body.

\end{itemize}

\section{Contributions to knowledge}
 
\begin{enumerate}

\item \textbf{Developing and validating a novel skin lesion segmentation approach for accurate border cut-off segmentation to improve border irregularity analysis using SegNet and LBPC.}

SegNet is highly accurate at finding the area for the segmentation of skin lesions but is inaccurate for measuring border irregularities because the border cut-off between skin and skin lesion is insufficient. Border irregularity detection necessitates an accurate cut-off for more reliable results, which SegNet does not provide. LBPC solves this problem by exaggerating the cut-off and improving the accuracy of border irregularity detection. However, the disadvantage of LBPC is its inaccuracy when finding the skin lesion area. By combining SegNet and LBPC, detecting the skin lesion area using SegNet, followed by adjusting the border with LBPC; retaining the accuracy of SegNet while improving the border cut-off accuracy. Experimental testing utilising the PH$^2$ dataset containing expert segmentation data will determine the benefits of segmentation.

\item \textbf{Developing and validating a novel asymmetry analysis approach for improved irregular asymmetry detection in skin lesions using moment-based texture analysis for improved bi-fold analysis and superpixels for improved asymmetry colour comparisons.}

The disadvantage of asymmetry measuring techniques for skin lesions is rotational moments for creating bi-folds. Current bi-folds solely consider the silhouette of the skin lesion, with no consideration towards colour or texture. Furthermore, recent techniques have measured asymmetrical irregularities based on colour and texture. Producing a bi-fold based on the shape, colour, and texture using moment-based texture analysis should improve the accuracy of asymmetry detection. In addition, utilising superpixels to measure colour asymmetry to avoid merging important features improves accuracy. Both techniques will be validated using the PH$^2$ asymmetrical score.  

\item \textbf{Developing and validating a novel interpretable melanoma classifier for improved interpretability of ABCD rules (asymmetry, border, colour, and dermoscopic structures) using feature extraction, support vector machines (SVM), and Bayesian fusion.}

The disadvantage of many neural network-oriented techniques is their lack of adequate interpretability, making them challenging to utilise in clinical environments. However, ABCD rules (asymmetry, border, colour, and dermoscopic structures) are a diagnostic procedure that most doctors are familiar with; therefore, developing a system automating this procedure is beneficial. Feature extraction techniques aim to separate the data essential for each ABCD rule and train an SVM model from the extracted features. For example, bi-folds measure asymmetry, which can be modified to train an SVM model. Repeating this for border, colour, and dermoscopic structures ensures that each rule is independent. Finally, combining the Bayesian fusion results measures the probabilistic significance between ABCD rules and combines them into benign or malignant. Techniques will be validated using the PH$^2$ dataset for testing ABCD rules and ISIC 2018 datasets for diagnosis.

\item \textbf{Developing and validating a novel interpretable melanoma classifier with meta-data including age, gender, feeling, and location on the body to improve classification accuracy between melanoma and seborrhoeic keratosis (SK) using Bayesian probability for a modifiable probabilistic analysis.}

Seborrhoeic keratosis (SK) is a melanoma mimic because it sometimes shares clinical features with melanoma. Moreover, differentiating between the two with entirely image data can lead to inaccuracies. Including meta-data age, gender, feeling, and location on the body should improve accuracy because SK appears more frequently on the head or back of old male patients. Bayesian probability networks are considered highly modifiable and can generate results with incomplete input, meaning meta-data is only inputted when necessary, benefiting doctors and improving the diagnosis. The associated organisation has a vast amount of valuable meta-data alongside image data of skin lesions; a private dataset will be created from these results and used to validate results.


\end{enumerate}